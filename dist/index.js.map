{"version":3,"file":"index.js","sources":["../src/utils/generateId.ts","../src/utils/dev.ts","../src/utils/LocationHistory.ts","../src/ReactRouter/ViewStacks.ts","../src/ReactRouter/RouteManagerContext.ts","../src/ReactRouter/View.tsx","../src/ReactRouter/ViewTransitionManager.tsx","../src/ReactRouter/StackManager.tsx","../src/ReactRouter/NavManager.tsx","../src/ReactRouter/Router.tsx","../src/ReactRouter/IonReactRouter.tsx","../src/ReactRouter/IonReactHashRouter.tsx"],"sourcesContent":["let count = 0;\n\nexport const generateId = () => (count++).toString();\n","export const isDevMode = () => {\n  return process && process.env && process.env.NODE_ENV === 'development';\n};\n\nexport const deprecationWarning = (message: string) => {\n  if (isDevMode()) {\n    console.warn(message);\n  }\n};\n","import { Location as HistoryLocation } from 'history';\n\nconst RESTRICT_SIZE = 25;\n\nexport class LocationHistory {\n  locationHistory: HistoryLocation[] = [];\n\n  add(location: HistoryLocation) {\n    this.locationHistory.push(location);\n    if (this.locationHistory.length > RESTRICT_SIZE) {\n      this.locationHistory.splice(0, 10);\n    }\n  }\n\n  findLastLocation(url: string) {\n    const reversedLocations = [...this.locationHistory].reverse();\n    const last = reversedLocations.find(x => x.pathname.toLowerCase() === url.toLowerCase());\n    return last;\n  }\n}\n","import { Location as HistoryLocation } from 'history';\nimport { matchPath } from 'react-router-dom';\n\nimport { IonRouteData } from './IonRouteData';\nimport { ViewItem } from './ViewItem';\n\nexport interface ViewStack {\n  id: string;\n  routerOutlet: HTMLIonRouterOutletElement;\n  views: ViewItem[];\n  activeViewIdQueue: string[];\n}\n\n/**\n * The holistic view of all the Routes configured for an application inside of an IonRouterOutlet.\n */\nexport class ViewStacks {\n  private viewStacks: { [key: string]: ViewStack | undefined } = {};\n\n  get(key: string) {\n    return this.viewStacks[key];\n  }\n\n  set(key: string, viewStack: ViewStack) {\n    this.viewStacks[key] = viewStack;\n  }\n\n  getKeys() {\n    return Object.keys(this.viewStacks);\n  }\n\n  delete(key: string) {\n    delete this.viewStacks[key];\n  }\n\n  findViewInfoByLocation(location: HistoryLocation, viewKey?: string) {\n    let view: ViewItem<IonRouteData> | undefined;\n    let match: IonRouteData['match'] | null | undefined;\n    let viewStack: ViewStack | undefined;\n    if (viewKey) {\n      viewStack = this.viewStacks[viewKey];\n      if (viewStack) {\n        [...viewStack.views].reverse().some(matchView);\n      }\n    } else {\n      const keys = this.getKeys();\n      keys.some(key => {\n        viewStack = this.viewStacks[key];\n        [...viewStack!.views].reverse().some(matchView);\n      });\n    }\n\n    const result = { view, viewStack, match };\n    return result;\n\n    function matchView(v: ViewItem) {\n      const matchProps = {\n        exact: v.routeData.childProps.exact,\n        path: v.routeData.childProps.path || v.routeData.childProps.from,\n        component: v.routeData.childProps.component\n      };\n      match = matchPath(location.pathname, matchProps);\n\n      if (\n        (v as any)._location &&\n        location.pathname !== (v as any)._location.pathname\n      ) {\n        match = null;\n      }\n\n      if (match) {\n        view = v;\n        return true;\n      }\n      return false;\n    }\n  }\n\n  findViewInfoById(id = '') {\n    let view: ViewItem<IonRouteData> | undefined;\n    let viewStack: ViewStack | undefined;\n    const keys = this.getKeys();\n    keys.some(key => {\n      const vs = this.viewStacks[key];\n      view = vs!.views.find(x => x.id === id);\n      if (view) {\n        viewStack = vs;\n        return true;\n      } else {\n        return false;\n      }\n    });\n    return { view, viewStack };\n  }\n}\n","import React, { ReactNode } from 'react';\n\nimport { ViewStacks } from './ViewStacks';\n\nexport interface RouteManagerContextState {\n  syncView: (page: HTMLElement, viewId: string) => void;\n  hideView: (viewId: string) => void;\n  viewStacks: ViewStacks;\n  setupIonRouter: (\n    id: string,\n    children: ReactNode,\n    routerOutlet: HTMLIonRouterOutletElement\n  ) => Promise<void>;\n  removeViewStack: (stack: string) => void;\n  removeCloneView: (viewId: string) => void;\n}\n\nexport const RouteManagerContext = /*@__PURE__*/ React.createContext<\n  RouteManagerContextState\n>({\n  viewStacks: new ViewStacks(),\n  syncView: () => {\n    navContextNotFoundError();\n  },\n  hideView: () => {\n    navContextNotFoundError();\n  },\n  setupIonRouter: () => Promise.reject(navContextNotFoundError()),\n  removeViewStack: () => {\n    navContextNotFoundError();\n  },\n  removeCloneView: () => {\n    navContextNotFoundError();\n  }\n});\n\nfunction navContextNotFoundError() {\n  console.error('IonReactRouter not found, did you add it to the app?');\n}\n","import { IonLifeCycleContext, NavContext } from '@ionic/react';\nimport React from 'react';\nimport { Redirect, Route } from 'react-router-dom';\n\nimport { isDevMode } from '../utils';\n\nimport { ViewItem } from './ViewItem';\n\ninterface ViewProps extends React.HTMLAttributes<HTMLElement> {\n  onViewSync: (page: HTMLElement, viewId: string) => void;\n  onHideView: (viewId: string) => void;\n  view: ViewItem;\n}\n\n/**\n * The View component helps manage the IonPage's lifecycle and registration\n */\nexport class View extends React.Component<ViewProps, {}> {\n  context!: React.ContextType<typeof IonLifeCycleContext>;\n  ionPage?: HTMLElement;\n\n  componentDidMount() {\n    /**\n     * If we can tell if view is a redirect, hide it so it will work again in future\n     */\n    const { view } = this.props;\n    if (view.route.type === Redirect) {\n      this.props.onHideView(view.id);\n    } else if (view.route.type === Route && view.route.props.render) {\n      if (view.route.props.render().type === Redirect) {\n        this.props.onHideView(view.id);\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.ionPage) {\n      this.ionPage.removeEventListener('ionViewWillEnter', this.ionViewWillEnterHandler.bind(this));\n      this.ionPage.removeEventListener('ionViewDidEnter', this.ionViewDidEnterHandler.bind(this));\n      this.ionPage.removeEventListener('ionViewWillLeave', this.ionViewWillLeaveHandler.bind(this));\n      this.ionPage.removeEventListener('ionViewDidLeave', this.ionViewDidLeaveHandler.bind(this));\n    }\n  }\n\n  ionViewWillEnterHandler() {\n    this.context.ionViewWillEnter();\n  }\n\n  ionViewDidEnterHandler() {\n    this.context.ionViewDidEnter();\n  }\n\n  ionViewWillLeaveHandler() {\n    this.context.ionViewWillLeave();\n  }\n\n  ionViewDidLeaveHandler() {\n    this.context.ionViewDidLeave();\n  }\n\n  registerIonPage(page: HTMLElement) {\n    this.ionPage = page;\n    this.ionPage.addEventListener('ionViewWillEnter', this.ionViewWillEnterHandler.bind(this));\n    this.ionPage.addEventListener('ionViewDidEnter', this.ionViewDidEnterHandler.bind(this));\n    this.ionPage.addEventListener('ionViewWillLeave', this.ionViewWillLeaveHandler.bind(this));\n    this.ionPage.addEventListener('ionViewDidLeave', this.ionViewDidLeaveHandler.bind(this));\n    this.ionPage.classList.add('ion-page-invisible');\n    if (isDevMode()) {\n      this.ionPage.setAttribute('data-view-id', this.props.view.id);\n    }\n    this.props.onViewSync(page, this.props.view.id);\n  }\n\n  render() {\n    return (\n      <NavContext.Consumer>\n        {value => {\n          const newProvider = {\n            ...value,\n            registerIonPage: this.registerIonPage.bind(this)\n          };\n          return (\n            <NavContext.Provider value={newProvider}>\n              {this.props.children}\n            </NavContext.Provider>\n          );\n\n        }}\n      </NavContext.Consumer>\n    );\n  }\n\n  static get contextType() {\n    return IonLifeCycleContext;\n  }\n}\n","import { DefaultIonLifeCycleContext, IonLifeCycleContext } from '@ionic/react';\nimport React from 'react';\n\nimport { RouteManagerContext } from './RouteManagerContext';\n\ninterface ViewTransitionManagerProps {\n  id: string;\n  mount: boolean;\n}\n\ninterface ViewTransitionManagerState {\n  show: boolean;\n}\n\n/**\n * Manages the View's DOM lifetime by keeping it around long enough to complete page transitions before removing it.\n */\nexport class ViewTransitionManager extends React.Component<ViewTransitionManagerProps, ViewTransitionManagerState> {\n  ionLifeCycleContext = new DefaultIonLifeCycleContext();\n  _isMounted = false;\n  context!: React.ContextType<typeof RouteManagerContext>;\n\n  constructor(props: ViewTransitionManagerProps) {\n    super(props);\n    this.state = {\n      show: true\n    };\n\n    this.ionLifeCycleContext.onComponentCanBeDestroyed(() => {\n      if (!this.props.mount) {\n        if (this._isMounted) {\n          this.setState({\n            show: false\n          }, () => {\n            this.context.hideView(this.props.id);\n            // bugfix: remove clone view after go back\n            this.context.removeCloneView(this.props.id);\n          });\n        }\n      }\n    });\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  render() {\n    const { show } = this.state;\n    return (\n      <IonLifeCycleContext.Provider value={this.ionLifeCycleContext}>\n        {show && this.props.children}\n      </IonLifeCycleContext.Provider>\n    );\n  }\n\n  static get contextType() {\n    return RouteManagerContext;\n  }\n}\n","import React from 'react';\n\nimport { generateId, isDevMode } from '../utils';\n\nimport { RouteManagerContext } from './RouteManagerContext';\nimport { View } from './View';\nimport { ViewItem } from './ViewItem';\nimport { ViewTransitionManager } from './ViewTransitionManager';\n\ninterface StackManagerProps {\n  id?: string;\n}\n\nexport class StackManager extends React.Component<StackManagerProps, {}> {\n  routerOutletEl: React.RefObject<HTMLIonRouterOutletElement> = React.createRef();\n  context!: React.ContextType<typeof RouteManagerContext>;\n  id: string;\n\n  constructor(props: StackManagerProps) {\n    super(props);\n    this.id = this.props.id || generateId();\n    this.handleViewSync = this.handleViewSync.bind(this);\n    this.handleHideView = this.handleHideView.bind(this);\n  }\n\n  componentDidMount() {\n    this.context.setupIonRouter(this.id, this.props.children, this.routerOutletEl.current!);\n  }\n\n  componentWillUnmount() {\n    this.context.removeViewStack(this.id);\n  }\n\n  handleViewSync(page: HTMLElement, viewId: string) {\n    this.context.syncView(page, viewId);\n  }\n\n  handleHideView(viewId: string) {\n    this.context.hideView(viewId);\n  }\n\n  renderChild(item: ViewItem) {\n    const component = React.cloneElement(item.route, {\n      computedMatch: item.routeData.match\n    });\n    return component;\n  }\n\n  render() {\n    const context = this.context;\n    const viewStack = context.viewStacks.get(this.id);\n    const views = (viewStack || { views: [] }).views.filter(x => x.show);\n    const ionRouterOutlet = React.Children.only(this.props.children) as React.ReactElement;\n\n    const childElements = views.map(view => {\n      return (\n        <ViewTransitionManager\n          id={view.id}\n          key={view.key}\n          mount={view.mount}\n        >\n          <View\n            onViewSync={this.handleViewSync}\n            onHideView={this.handleHideView}\n            view={view}\n          >\n            {this.renderChild(view)}\n          </View>\n        </ViewTransitionManager>\n      );\n    });\n\n    const elementProps: any = {\n      ref: this.routerOutletEl\n    };\n\n    if (isDevMode()) {\n      elementProps['data-stack-id'] = this.id;\n    }\n\n    const routerOutletChild = React.cloneElement(ionRouterOutlet, elementProps, childElements);\n\n    return routerOutletChild;\n  }\n\n  static get contextType() {\n    return RouteManagerContext;\n  }\n}\n","import { RouterDirection } from '@ionic/core';\nimport { NavContext, NavContextState } from '@ionic/react';\nimport { Location as HistoryLocation, UnregisterCallback } from 'history';\nimport React from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\n\nimport { generateId } from '../utils';\nimport { LocationHistory } from '../utils/LocationHistory';\n\nimport { StackManager } from './StackManager';\nimport { ViewItem } from './ViewItem';\nimport { ViewStack } from './ViewStacks';\n\ninterface NavManagerProps extends RouteComponentProps {\n  findViewInfoByLocation: (location: HistoryLocation) => { view?: ViewItem, viewStack?: ViewStack };\n  findViewInfoById: (id: string) => { view?: ViewItem, viewStack?: ViewStack };\n  getActiveIonPage: () => { view?: ViewItem, viewStack?: ViewStack };\n  onNavigate: (type: 'push' | 'replace', path: string, state?: any) => void;\n}\n\nexport class NavManager extends React.Component<NavManagerProps, NavContextState> {\n\n  listenUnregisterCallback: UnregisterCallback | undefined;\n  locationHistory: LocationHistory = new LocationHistory();\n\n  constructor(props: NavManagerProps) {\n    super(props);\n    this.state = {\n      goBack: this.goBack.bind(this),\n      hasIonicRouter: () => true,\n      navigate: this.navigate.bind(this),\n      getStackManager: this.getStackManager.bind(this),\n      getPageManager: this.getPageManager.bind(this),\n      currentPath: this.props.location.pathname,\n      registerIonPage: () => { return; }, // overridden in View for each IonPage\n      tabNavigate: this.tabNavigate.bind(this)\n    } as any;\n\n    this.listenUnregisterCallback = this.props.history.listen((location: HistoryLocation) => {\n      this.setState({\n        currentPath: location.pathname\n      });\n      this.locationHistory.add(location);\n    });\n\n    this.locationHistory.add({\n      hash: window.location.hash,\n      key: generateId(),\n      pathname: window.location.pathname,\n      search: window.location.search,\n      state: {}\n    });\n  }\n\n  componentWillUnmount() {\n    if (this.listenUnregisterCallback) {\n      this.listenUnregisterCallback();\n    }\n  }\n\n  goBack(defaultHref?: string) {\n    const { view: activeIonPage } = this.props.getActiveIonPage();\n    if (activeIonPage) {\n      const { view: enteringView } = this.props.findViewInfoById(activeIonPage.prevId!);\n      if (enteringView) {\n        const lastLocation = this.locationHistory.findLastLocation(enteringView.routeData.match.url);\n        if (lastLocation) {\n          this.props.onNavigate('replace', lastLocation.pathname + lastLocation.search, 'back');\n        } else {\n          this.props.onNavigate('replace', enteringView.routeData.match.url, 'back');\n        }\n      } else {\n        if (defaultHref) {\n          this.props.onNavigate('replace', defaultHref, 'back');\n        }\n      }\n    } else {\n      if (defaultHref) {\n        this.props.onNavigate('replace', defaultHref, 'back');\n      }\n    }\n  }\n\n  navigate(path: string, direction?: RouterDirection | 'none') {\n    this.props.onNavigate('push', path, direction);\n  }\n\n  tabNavigate(path: string) {\n    this.props.onNavigate('replace', path, 'back');\n  }\n\n  getPageManager() {\n    return (children: any) => children;\n  }\n\n  getStackManager() {\n    return StackManager;\n  }\n\n  render() {\n    return (\n      <NavContext.Provider value={this.state}>\n        {this.props.children}\n      </NavContext.Provider>\n    );\n  }\n\n}\n","import { NavDirection } from '@ionic/core';\nimport { RouterDirection } from '@ionic/react';\nimport {\n  Action as HistoryAction,\n  Location as HistoryLocation,\n  UnregisterCallback\n} from 'history';\nimport React from 'react';\nimport { RouteComponentProps, matchPath, withRouter } from 'react-router-dom';\n\nimport { generateId } from '../utils';\n\nimport { IonRouteData } from './IonRouteData';\nimport { NavManager } from './NavManager';\nimport {\n  RouteManagerContext,\n  RouteManagerContextState\n} from './RouteManagerContext';\nimport { ViewItem } from './ViewItem';\nimport { ViewStack, ViewStacks } from './ViewStacks';\n\ninterface RouteManagerState extends RouteManagerContextState {\n  location?: HistoryLocation;\n  action?: HistoryAction;\n}\n\nclass RouteManager extends React.Component<\n  RouteComponentProps,\n  RouteManagerState\n> {\n  listenUnregisterCallback: UnregisterCallback | undefined;\n  activeIonPageId?: string;\n  currentDirection?: RouterDirection;\n\n  constructor(props: RouteComponentProps) {\n    super(props);\n    this.listenUnregisterCallback = this.props.history.listen(\n      this.historyChange.bind(this)\n    );\n    this.handleNavigate = this.handleNavigate.bind(this);\n    this.state = {\n      viewStacks: new ViewStacks(),\n      hideView: this.hideView.bind(this),\n      setupIonRouter: this.setupIonRouter.bind(this),\n      removeViewStack: this.removeViewStack.bind(this),\n      syncView: this.syncView.bind(this),\n      removeCloneView: this.removeCloneView.bind(this)\n    };\n  }\n\n  componentDidUpdate(\n    _prevProps: RouteComponentProps,\n    prevState: RouteManagerState\n  ) {\n    // Trigger a page change if the location or action is different\n    if (\n      (this.state.location && prevState.location !== this.state.location) ||\n      prevState.action !== this.state.action\n    ) {\n      this.setActiveView(this.state.location!, this.state.action!);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.listenUnregisterCallback) {\n      this.listenUnregisterCallback();\n    }\n  }\n\n  hideView(viewId: string) {\n    const viewStacks = Object.assign(new ViewStacks(), this.state.viewStacks);\n    const { view } = viewStacks.findViewInfoById(viewId);\n    if (view) {\n      view.show = false;\n      view.ionPageElement = undefined;\n      view.isIonRoute = false;\n      view.prevId = undefined;\n      view.key = generateId();\n      this.setState({\n        viewStacks\n      });\n    }\n  }\n\n  historyChange(location: HistoryLocation, action: HistoryAction) {\n    location.state = location.state || { direction: this.currentDirection };\n    const fixedLocation = this.fixLocation(location, action);\n    this.currentDirection = undefined;\n    this.setState({\n      location: fixedLocation.location,\n      action: fixedLocation.action\n    });\n  }\n\n  setActiveView(location: HistoryLocation, action: HistoryAction) {\n    const viewStacks = Object.assign(new ViewStacks(), this.state.viewStacks);\n    let direction: RouterDirection | undefined =\n      (location.state && location.state.direction) || 'forward';\n    let leavingView: ViewItem | undefined;\n    const viewStackKeys = viewStacks.getKeys();\n\n    viewStackKeys.forEach(key => {\n      const {\n        view: enteringView,\n        viewStack: enteringViewStack,\n        match\n      } = viewStacks.findViewInfoByLocation(location, key);\n      if (!enteringView || !enteringViewStack) {\n        return;\n      }\n      leavingView = viewStacks.findViewInfoById(this.activeIonPageId).view;\n\n      if (enteringView.isIonRoute) {\n        enteringView.show = true;\n        enteringView.mount = true;\n        enteringView.routeData.match = match!;\n\n        this.activeIonPageId = enteringView.id;\n\n        if (leavingView) {\n          if (direction === 'forward') {\n            if (action === 'PUSH') {\n              /**\n               * If the page is being pushed into the stack by another view,\n               * record the view that originally directed to the new view for back button purposes.\n               */\n              enteringView.prevId = enteringView.prevId || leavingView.id;\n            } else if (action === 'POP') {\n              direction =\n                leavingView.prevId === enteringView.id ? 'back' : 'none';\n            } else {\n              direction = direction || 'back';\n              leavingView.mount = false;\n            }\n          } else if (direction === 'back' || action === 'REPLACE') {\n            leavingView.mount = false;\n          }\n        } else {\n          // If there is not a leavingView, then we shouldn't provide a direction\n          direction = undefined;\n        }\n        this.removeOrphanedViews(enteringView, enteringViewStack);\n      } else {\n        enteringView.show = true;\n        enteringView.mount = true;\n        enteringView.routeData.match = match!;\n      }\n    });\n\n    if (leavingView) {\n      if (!leavingView.isIonRoute) {\n        leavingView.mount = false;\n        leavingView.show = false;\n      }\n    }\n\n    this.setState(\n      {\n        viewStacks\n      },\n      () => {\n        const {\n          view: enteringView,\n          viewStack\n        } = this.state.viewStacks.findViewInfoById(this.activeIonPageId);\n        if (enteringView && viewStack) {\n          const enteringEl = enteringView.ionPageElement\n            ? enteringView.ionPageElement\n            : undefined;\n          const leavingEl =\n            leavingView && leavingView.ionPageElement\n              ? leavingView.ionPageElement\n              : undefined;\n          if (enteringEl) {\n            // Don't animate from an empty view\n            const navDirection =\n              leavingEl && leavingEl.innerHTML === ''\n                ? undefined\n                : direction === 'none'\n                ? undefined\n                : direction;\n            this.transitionView(\n              enteringEl!,\n              leavingEl!,\n              viewStack.routerOutlet,\n              navDirection,\n              !!enteringView.prevId\n            );\n          } else if (leavingEl) {\n            leavingEl.classList.add('ion-page-hidden');\n            leavingEl.setAttribute('aria-hidden', 'true');\n          }\n        }\n      }\n    );\n  }\n\n  fixLocation(location: HistoryLocation, action: HistoryAction) {\n    let direction = location.state && location.state.direction;\n\n    if (direction !== 'forward' && action === 'POP') {\n      const viewStacks = Object.assign(new ViewStacks(), this.state.viewStacks);\n      const viewStackKeys = viewStacks.getKeys();\n      viewStackKeys.forEach(key => {\n        const { view } = viewStacks.findViewInfoByLocation(location, key);\n        if (view) {\n          direction = 'back';\n        } else {\n          direction = 'forward';\n          action = 'PUSH';\n        }\n\n        location.state = { ...location.state, direction };\n      });\n    }\n\n    direction = direction || 'forward';\n\n    // clone view if location in history\n    if (direction === 'forward' && action === 'PUSH') {\n      let matchedViewInfo: ReturnType<\n        typeof ViewStacks['prototype']['findViewInfoByLocation']\n      > | undefined;\n      let matchedStack: ViewStack | undefined;\n\n      const viewStackKeys = this.state.viewStacks.getKeys();\n      viewStackKeys.some(key => {\n        const viewInfo = this.state.viewStacks.findViewInfoByLocation(\n          location,\n          key\n        );\n\n        if (viewInfo.view) {\n          matchedViewInfo = viewInfo;\n          matchedStack = this.state.viewStacks.get(key)!;\n          return true;\n        }\n        return false;\n      });\n\n      if (matchedViewInfo && matchedStack) {\n        const { view, match } = matchedViewInfo;\n        matchedStack.activeViewIdQueue = matchedStack.activeViewIdQueue || [];\n\n        if (view!.show) {\n          const cloneView = {\n            ...view,\n            _location: location,\n            id: generateId(),\n            key: generateId(),\n            routeData: {\n              match,\n              childProps: view!.routeData.childProps\n            },\n            ionPageElement: undefined,\n            mount: false,\n            show: false,\n            isIonRoute: false,\n            prevId: null\n          };\n\n          matchedStack.views.push(cloneView as any);\n          matchedStack.activeViewIdQueue.push(cloneView.id);\n        } else {\n          matchedStack.activeViewIdQueue.push(view!.id);\n        }\n      }\n    }\n\n    return {\n      location,\n      action\n    };\n  }\n\n  removeCloneView() {\n    let matchedViewInfo: ReturnType<\n      typeof ViewStacks['prototype']['findViewInfoByLocation']\n    > | undefined;\n    let matchedStack: ViewStack | undefined;\n\n    const viewStackKeys = this.state.viewStacks.getKeys();\n    viewStackKeys.some(key => {\n      const viewInfo = this.state.viewStacks.findViewInfoByLocation(\n        this.state.location!,\n        key\n      );\n\n      if (viewInfo.view) {\n        matchedViewInfo = viewInfo;\n        matchedStack = this.state.viewStacks.get(key)!;\n        return true;\n      }\n      return false;\n    });\n\n    if (matchedViewInfo && matchedStack) {\n      const enteringView = matchedViewInfo.view!;\n      const index = matchedStack.activeViewIdQueue.indexOf(enteringView!.id);\n      const removeIds = matchedStack.activeViewIdQueue.slice(index + 1);\n      const views = matchedStack.views;\n      const removeViews = views.filter(\n        (v: any) => v._location && removeIds.indexOf(v.id) !== -1\n      );\n      removeViews.forEach(v => {\n        views.splice(views.indexOf(v), 1);\n      });\n      matchedStack.activeViewIdQueue = matchedStack.activeViewIdQueue.slice(0, index + 1);\n    }\n  }\n\n  removeOrphanedViews(view: ViewItem, viewStack: ViewStack) {\n    const viewsToRemove = viewStack.views.filter(v => v.prevId === view.id);\n    viewsToRemove.forEach(v => {\n      // Don't remove if view is currently active\n      if (v.id !== this.activeIonPageId) {\n        this.removeOrphanedViews(v, viewStack);\n\n        // If view is not currently visible, go ahead and remove it from DOM\n        if (v.ionPageElement!.classList.contains('ion-page-hidden')) {\n          v.show = false;\n          v.ionPageElement = undefined;\n          v.isIonRoute = false;\n          v.prevId = undefined;\n          v.key = generateId();\n        }\n        v.mount = false;\n      }\n    });\n  }\n\n  async setupIonRouter(\n    id: string,\n    children: any,\n    routerOutlet: HTMLIonRouterOutletElement\n  ) {\n    const views: ViewItem[] = [];\n    let activeId: string | undefined;\n    const ionRouterOutlet = React.Children.only(children) as React.ReactElement;\n    React.Children.forEach(\n      ionRouterOutlet.props.children,\n      (child: React.ReactElement) => {\n        views.push(createViewItem(child, this.props.history.location));\n      }\n    );\n\n    await this.registerViewStack(\n      id,\n      activeId,\n      views,\n      routerOutlet,\n      this.props.location\n    );\n\n    function createViewItem(\n      child: React.ReactElement<any>,\n      location: HistoryLocation\n    ) {\n      const viewId = generateId();\n      const key = generateId();\n      const route = child;\n      const matchProps = {\n        exact: child.props.exact,\n        path: child.props.path || child.props.from,\n        component: child.props.component\n      };\n      const match: IonRouteData['match'] = matchPath(\n        location.pathname,\n        matchProps\n      );\n      const view: ViewItem<IonRouteData> = {\n        id: viewId,\n        key,\n        routeData: {\n          match,\n          childProps: child.props\n        },\n        route,\n        mount: true,\n        show: !!match,\n        isIonRoute: false\n      };\n      if (match && view.isIonRoute) {\n        activeId = viewId;\n      }\n      return view;\n    }\n  }\n\n  async registerViewStack(\n    stack: string,\n    activeId: string | undefined,\n    stackItems: ViewItem[],\n    routerOutlet: HTMLIonRouterOutletElement,\n    _location: HistoryLocation\n  ) {\n    return new Promise(resolve => {\n      this.setState(\n        prevState => {\n          const prevViewStacks = Object.assign(\n            new ViewStacks(),\n            prevState.viewStacks\n          );\n          const newStack: ViewStack = {\n            id: stack,\n            views: stackItems,\n            routerOutlet,\n            activeViewIdQueue: [],\n          };\n          if (activeId) {\n            this.activeIonPageId = activeId;\n          }\n          prevViewStacks.set(stack, newStack);\n          return {\n            viewStacks: prevViewStacks\n          };\n        },\n        () => {\n          resolve();\n        }\n      );\n    });\n  }\n\n  removeViewStack(stack: string) {\n    const viewStacks = Object.assign(new ViewStacks(), this.state.viewStacks);\n    viewStacks.delete(stack);\n    this.setState({\n      viewStacks\n    });\n  }\n\n  syncView(page: HTMLElement, viewId: string) {\n    this.setState(\n      state => {\n        const viewStacks = Object.assign(new ViewStacks(), state.viewStacks);\n        const { view } = viewStacks.findViewInfoById(viewId);\n\n        view!.ionPageElement = page;\n        view!.isIonRoute = true;\n\n        return {\n          viewStacks\n        };\n      },\n      () => {\n        this.setActiveView(\n          this.state.location || this.props.location,\n          this.state.action!\n        );\n      }\n    );\n  }\n\n  transitionView(\n    enteringEl: HTMLElement,\n    leavingEl: HTMLElement,\n    ionRouterOutlet: HTMLIonRouterOutletElement | undefined,\n    direction: NavDirection | undefined,\n    showGoBack: boolean\n  ) {\n    /**\n     * Super hacky workaround to make sure ionRouterOutlet is available\n     * since transitionView might be called before IonRouterOutlet is fully mounted\n     */\n    if (ionRouterOutlet && ionRouterOutlet.componentOnReady) {\n      this.commitView(\n        enteringEl,\n        leavingEl,\n        ionRouterOutlet,\n        direction,\n        showGoBack\n      );\n    } else {\n      setTimeout(() => {\n        this.transitionView(\n          enteringEl,\n          leavingEl,\n          ionRouterOutlet,\n          direction,\n          showGoBack\n        );\n      }, 10);\n    }\n  }\n\n  private async commitView(\n    enteringEl: HTMLElement,\n    leavingEl: HTMLElement,\n    ionRouterOuter: HTMLIonRouterOutletElement,\n    direction?: NavDirection,\n    showGoBack?: boolean\n  ) {\n    if (enteringEl === leavingEl) {\n      return;\n    }\n\n    await ionRouterOuter.commit(enteringEl, leavingEl, {\n      deepWait: true,\n      duration: direction === undefined ? 0 : undefined,\n      direction,\n      showGoBack,\n      progressAnimation: false\n    });\n\n    if (leavingEl && enteringEl !== leavingEl) {\n      /** add hidden attributes */\n      leavingEl.classList.add('ion-page-hidden');\n      leavingEl.setAttribute('aria-hidden', 'true');\n    }\n  }\n\n  handleNavigate(\n    type: 'push' | 'replace',\n    path: string,\n    direction?: RouterDirection\n  ) {\n    this.currentDirection = direction;\n    if (type === 'push') {\n      this.props.history.push(path);\n    } else {\n      this.props.history.replace(path);\n    }\n  }\n\n  render() {\n    return (\n      <RouteManagerContext.Provider value={this.state}>\n        <NavManager\n          {...this.props}\n          onNavigate={this.handleNavigate}\n          findViewInfoById={(id: string) =>\n            this.state.viewStacks.findViewInfoById(id)\n          }\n          findViewInfoByLocation={(location: HistoryLocation) =>\n            this.state.viewStacks.findViewInfoByLocation(location)\n          }\n          getActiveIonPage={() =>\n            this.state.viewStacks.findViewInfoById(this.activeIonPageId)\n          }\n        >\n          {this.props.children}\n        </NavManager>\n      </RouteManagerContext.Provider>\n    );\n  }\n}\n\nexport const RouteManagerWithRouter = withRouter(RouteManager);\nRouteManagerWithRouter.displayName = 'RouteManager';\n","import React from 'react';\nimport { BrowserRouter, BrowserRouterProps } from 'react-router-dom';\n\nimport { RouteManagerWithRouter } from './Router';\n\nexport class IonReactRouter extends React.Component<BrowserRouterProps> {\n  render() {\n    const { children, ...props } = this.props;\n    return (\n      <BrowserRouter {...props}>\n        <RouteManagerWithRouter>{children}</RouteManagerWithRouter>\n      </BrowserRouter>\n    );\n  }\n}\n","import React from 'react';\nimport { HashRouter, HashRouterProps } from 'react-router-dom';\n\nimport { RouteManagerWithRouter } from './Router';\n\nexport class IonReactHashRouter extends React.Component<HashRouterProps> {\n  render() {\n    const { children, ...props } = this.props;\n    return (\n      <HashRouter {...props}>\n        <RouteManagerWithRouter>{children}</RouteManagerWithRouter>\n      </HashRouter>\n    );\n  }\n}\n"],"names":["matchPath","Redirect","Route","NavContext","IonLifeCycleContext","DefaultIonLifeCycleContext","withRouter","BrowserRouter","HashRouter"],"mappings":"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"}